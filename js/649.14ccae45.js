"use strict";(self["webpackChunkrequest_form"]=self["webpackChunkrequest_form"]||[]).push([[649],{7649:function(t,e,a){a.r(e),a.d(e,{default:function(){return v}});var s=function(){var t=this,e=t._self._c;return e("div",[e("h1",{staticClass:"py-4 px-5"},[t._v("Список заявок")]),e("div",{staticClass:"p-3"},[e("div",{staticClass:"request-table position-relative border-radius-8 px-3 py-7"},[t.loading?e("div",{staticClass:"loader position-absolute"},[t._m(0)]):t._e(),e("button",{staticClass:"main-button ms-auto mb-5",on:{click:t.showAppeal}},[t._v("СОЗДАТЬ")]),e("div",{staticClass:"d-flex mb-6"},[e("div",{staticClass:"request-table__input d-flex pb-3 me-3"},[e("input",{staticClass:"w-100",attrs:{type:"text",placeholder:"Поиск (№ заявки, название)",id:"searchAppealInput"},on:{input:t.searchAppealOnInput}}),e("button",{on:{click:t.searchAppealByClick}},[e("svg",{attrs:{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("mask",{staticStyle:{"mask-type":"alpha"},attrs:{id:"mask0_2002_52",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"24",height:"24"}},[e("rect",{attrs:{width:"24",height:"24",fill:"#D9D9D9"}})]),e("g",{attrs:{mask:"url(#mask0_2002_52)"}},[e("path",{attrs:{d:"M19.6 21L13.3 14.7C12.8 15.1 12.225 15.4167 11.575 15.65C10.925 15.8833 10.2333 16 9.5 16C7.68333 16 6.14583 15.3708 4.8875 14.1125C3.62917 12.8542 3 11.3167 3 9.5C3 7.68333 3.62917 6.14583 4.8875 4.8875C6.14583 3.62917 7.68333 3 9.5 3C11.3167 3 12.8542 3.62917 14.1125 4.8875C15.3708 6.14583 16 7.68333 16 9.5C16 10.2333 15.8833 10.925 15.65 11.575C15.4167 12.225 15.1 12.8 14.7 13.3L21 19.6L19.6 21ZM9.5 14C10.75 14 11.8125 13.5625 12.6875 12.6875C13.5625 11.8125 14 10.75 14 9.5C14 8.25 13.5625 7.1875 12.6875 6.3125C11.8125 5.4375 10.75 5 9.5 5C8.25 5 7.1875 5.4375 6.3125 6.3125C5.4375 7.1875 5 8.25 5 9.5C5 10.75 5.4375 11.8125 6.3125 12.6875C7.1875 13.5625 8.25 14 9.5 14Z",fill:"#999999"}})])])])]),e("div",{staticClass:"request-table__input d-flex pb-3"},[e("select",{staticClass:"w-100 cursor-pointer",attrs:{name:"",id:"premiseSelect"},on:{change:t.choosePremise}},[e("option",{attrs:{selected:"",value:""}},[t._v("Не выбрано")]),t._l(this.premisesData.results,(function(a){return e("option",{key:a.id,domProps:{value:a.id}},[t._v(" "+t._s(a?.full_address)+" ")])}))],2)])]),this.appealsData.results.length||t.loading?e("div",[e("table",{staticClass:"w-100 mb-6"},[e("tr",[e("th",{staticClass:"cursor-pointer"},[e("label",{attrs:{for:"number"},on:{click:function(e){return t.sortBy("number")}}},[e("input",{staticClass:"d-none",attrs:{type:"checkbox",id:"number"}}),t._v(" № "),e("svg",{staticClass:"ms-1 flex-shrink-0",attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("mask",{staticStyle:{"mask-type":"alpha"},attrs:{id:"mask0_2026_108",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"16"}},[e("rect",{attrs:{width:"16",height:"16",fill:"#D9D9D9"}})]),e("g",{attrs:{mask:"url(#mask0_2026_108)"}},[e("path",{staticClass:"ease-animation",attrs:{d:"M7.33333 12V5.86668L4.93333 8.26668L4 7.33334L8 3.33334L12 7.33334L11.0667 8.26668L8.66667 5.86668V12H7.33333Z",fill:"#CCCCCC"}})])])])]),e("th",{staticClass:"cursor-pointer"},[e("label",{attrs:{for:"created_at","data-sort":"created"},on:{click:function(e){return t.sortBy("created")}}},[e("input",{staticClass:"d-none",attrs:{type:"checkbox",id:"created_at"}}),t._v(" Создана "),e("svg",{staticClass:"ms-1 flex-shrink-0",attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("mask",{staticStyle:{"mask-type":"alpha"},attrs:{id:"mask0_2026_108",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"16"}},[e("rect",{attrs:{width:"16",height:"16",fill:"#D9D9D9"}})]),e("g",{attrs:{mask:"url(#mask0_2026_108)"}},[e("path",{staticClass:"ease-animation",attrs:{d:"M7.33333 12V5.86668L4.93333 8.26668L4 7.33334L8 3.33334L12 7.33334L11.0667 8.26668L8.66667 5.86668V12H7.33333Z",fill:"#CCCCCC"}})])])])]),e("th",{staticClass:"cursor-pointer"},[e("label",{attrs:{for:"address"},on:{click:function(e){return t.sortBy("address")}}},[e("input",{staticClass:"d-none",attrs:{type:"checkbox",id:"address"}}),t._v(" Адрес "),e("svg",{staticClass:"ms-1 flex-shrink-0",attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("mask",{staticStyle:{"mask-type":"alpha"},attrs:{id:"mask0_2026_108",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"16"}},[e("rect",{attrs:{width:"16",height:"16",fill:"#D9D9D9"}})]),e("g",{attrs:{mask:"url(#mask0_2026_108)"}},[e("path",{staticClass:"ease-animation",attrs:{d:"M7.33333 12V5.86668L4.93333 8.26668L4 7.33334L8 3.33334L12 7.33334L11.0667 8.26668L8.66667 5.86668V12H7.33333Z",fill:"#CCCCCC"}})])])])]),e("th",{staticClass:"cursor-pointer"},[e("label",{attrs:{for:"applicant"},on:{click:function(e){return t.sortBy("applicant")}}},[e("input",{staticClass:"d-none",attrs:{type:"checkbox",id:"applicant"}}),t._v(" Заявитель "),e("svg",{staticClass:"ms-1 flex-shrink-0",attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("mask",{staticStyle:{"mask-type":"alpha"},attrs:{id:"mask0_2026_108",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"16"}},[e("rect",{attrs:{width:"16",height:"16",fill:"#D9D9D9"}})]),e("g",{attrs:{mask:"url(#mask0_2026_108)"}},[e("path",{staticClass:"ease-animation",attrs:{d:"M7.33333 12V5.86668L4.93333 8.26668L4 7.33334L8 3.33334L12 7.33334L11.0667 8.26668L8.66667 5.86668V12H7.33333Z",fill:"#CCCCCC"}})])])])]),e("th",{staticClass:"cursor-pointer"},[e("label",{attrs:{for:"description"},on:{click:function(e){return t.sortBy("description")}}},[e("input",{staticClass:"d-none",attrs:{type:"checkbox",id:"description"}}),t._v(" Описание "),e("svg",{staticClass:"ms-1 flex-shrink-0",attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("mask",{staticStyle:{"mask-type":"alpha"},attrs:{id:"mask0_2026_108",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"16"}},[e("rect",{attrs:{width:"16",height:"16",fill:"#D9D9D9"}})]),e("g",{attrs:{mask:"url(#mask0_2026_108)"}},[e("path",{staticClass:"ease-animation",attrs:{d:"M7.33333 12V5.86668L4.93333 8.26668L4 7.33334L8 3.33334L12 7.33334L11.0667 8.26668L8.66667 5.86668V12H7.33333Z",fill:"#CCCCCC"}})])])])]),e("th",{staticClass:"cursor-pointer"},[e("label",{attrs:{for:"due_date"}},[e("input",{staticClass:"d-none",attrs:{type:"checkbox",id:"due_date"},on:{click:function(e){return t.sortBy("due_date")}}}),t._v(" Срок "),e("svg",{staticClass:"ms-1 flex-shrink-0",attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("mask",{staticStyle:{"mask-type":"alpha"},attrs:{id:"mask0_2026_108",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"16"}},[e("rect",{attrs:{width:"16",height:"16",fill:"#D9D9D9"}})]),e("g",{attrs:{mask:"url(#mask0_2026_108)"}},[e("path",{staticClass:"ease-animation",attrs:{d:"M7.33333 12V5.86668L4.93333 8.26668L4 7.33334L8 3.33334L12 7.33334L11.0667 8.26668L8.66667 5.86668V12H7.33333Z",fill:"#CCCCCC"}})])])])]),e("th",{staticClass:"cursor-pointer"},[e("label",{attrs:{for:"status"}},[e("input",{staticClass:"d-none",attrs:{type:"checkbox",id:"status"},on:{click:function(e){return t.sortBy("status")}}}),t._v(" Статус "),e("svg",{staticClass:"ms-1 flex-shrink-0",attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("mask",{staticStyle:{"mask-type":"alpha"},attrs:{id:"mask0_2026_108",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"16"}},[e("rect",{attrs:{width:"16",height:"16",fill:"#D9D9D9"}})]),e("g",{attrs:{mask:"url(#mask0_2026_108)"}},[e("path",{staticClass:"ease-animation",attrs:{d:"M7.33333 12V5.86668L4.93333 8.26668L4 7.33334L8 3.33334L12 7.33334L11.0667 8.26668L8.66667 5.86668V12H7.33333Z",fill:"#CCCCCC"}})])])])])]),t._l(this.appealsData.results,(function(a){return e("tr",{key:a.id},[e("td",[e("button",{staticClass:"border-radius-4 cursor-pointer",on:{click:function(e){return t.showAppeal(a.id)}}},[t._v(t._s(a.number))])]),e("td",[t._v(t._s(a?.created_at?t.getDate(a.created_at):"Данные отсутствуют"))]),e("td",[t._v(t._s(a.premise?.address?a.premise.address:"Данные отсутствуют"))]),e("td",[t._v(t._s(t.getApplicant(a)?.firstName&&t.getApplicant(a)?.lastName?t.getApplicant(a)?.firstName+" "+t.getApplicant(a)?.lastName:t.getApplicant(a)?.userName))]),e("td",[e("p",[t._v(t._s(a?.description?a.description:"Данные отсутствуют"))])]),e("td",[t._v(t._s(a?.due_date?t.getDate(a.due_date):"Данные отсутствуют"))]),e("td",[t._v(t._s(a?.status?.name?a.status.name:"Данные отсутствуют"))])])}))],2)]):e("div",{staticClass:"p-5 d-flex justify-content-center align-items-center w-100"},[e("h2",[t._v("Нет результатов")])]),this.paginationData.pages>1?e("div",{staticClass:"d-flex justify-content-between"},[e("div",{staticClass:"d-flex align-items-center"},[e("div",{staticClass:"me-3"},[e("b",[t._v(t._s(this.paginationData.page*this.paginationData.page_size-(this.paginationData.page_size-1))+"-"+t._s(this.paginationData.page*this.paginationData.page_size))]),t._v(" из "),e("b",[t._v(t._s(this.paginationData.pages*this.paginationData.page_size))]),t._v(" записей ")]),e("select",{attrs:{name:"page_size",id:"pageSize"},on:{change:t.changePageSize}},[e("option",{attrs:{value:"10",selected:""}},[t._v("10")]),e("option",{attrs:{value:"20"}},[t._v("20")]),e("option",{attrs:{value:"30"}},[t._v("30")]),e("option",{attrs:{value:"40"}},[t._v("40")]),e("option",{attrs:{value:"50"}},[t._v("50")])])]),e("div",{staticClass:"pagination d-flex align-items-center"},[1!==this.paginationData.page?e("button",{attrs:{"data-action":"first"},on:{click:t.changePage}},[e("svg",{attrs:{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("mask",{staticStyle:{"mask-type":"alpha"},attrs:{id:"mask0_2038_827",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"14",height:"14"}},[e("rect",{attrs:{width:"14",height:"14",fill:"#D9D9D9"}})]),e("g",{attrs:{mask:"url(#mask0_2038_827)"}},[e("path",{attrs:{d:"M6.41669 10.5L2.91669 7L6.41669 3.5L7.23335 4.31667L4.5646 7L7.23335 9.68333L6.41669 10.5ZM10.2667 10.5L6.76669 7L10.2667 3.5L11.0834 4.31667L8.4146 7L11.0834 9.68333L10.2667 10.5Z",fill:"#6C757D"}})])])]):t._e(),this.paginationData.page_previous?e("button",{attrs:{"data-action":"prev"},on:{click:t.changePage}},[e("svg",{attrs:{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("mask",{staticStyle:{"mask-type":"alpha"},attrs:{id:"mask0_2038_834",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"14",height:"14"}},[e("rect",{attrs:{width:"14",height:"14",fill:"#D9D9D9"}})]),e("g",{attrs:{mask:"url(#mask0_2038_834)"}},[e("path",{attrs:{d:"M8.16669 10.5L4.66669 7L8.16669 3.5L8.98335 4.31667L6.30002 7L8.98335 9.68333L8.16669 10.5Z",fill:"#6C757D"}})])])]):t._e(),e("div",{staticClass:"d-flex align-items-center"},t._l(t.getMaxPages(),(function(a){return e("button",{key:a,class:t.getCurrentPage(a)?"current":"",attrs:{"data-action":t.getPagesArray()+a},on:{click:t.changePage}},[t._v(" "+t._s(t.getPagesArray()+a)+" ")])})),0),this.paginationData.page_next?e("button",{attrs:{"data-action":"next"},on:{click:t.changePage}},[e("svg",{attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("mask",{staticStyle:{"mask-type":"alpha"},attrs:{id:"mask0_2038_869",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"16"}},[e("rect",{attrs:{width:"16",height:"16",fill:"#D9D9D9"}})]),e("g",{attrs:{mask:"url(#mask0_2038_869)"}},[e("path",{attrs:{d:"M8.40004 8L5.33337 4.93333L6.26671 4L10.2667 8L6.26671 12L5.33337 11.0667L8.40004 8Z",fill:"#6C757D"}})])])]):t._e(),this.paginationData.page!==this.paginationData.pages?e("button",{attrs:{"data-action":"last"},on:{click:t.changePage}},[e("svg",{attrs:{width:"16",height:"16",viewBox:"0 0 16 16",fill:"none",xmlns:"http://www.w3.org/2000/svg"}},[e("mask",{staticStyle:{"mask-type":"alpha"},attrs:{id:"mask0_2038_876",maskUnits:"userSpaceOnUse",x:"0",y:"0",width:"16",height:"16"}},[e("rect",{attrs:{width:"16",height:"16",fill:"#D9D9D9"}})]),e("g",{attrs:{mask:"url(#mask0_2038_876)"}},[e("path",{attrs:{d:"M6.38337 8L3.33337 4.93333L4.26671 4L8.26671 8L4.26671 12L3.33337 11.0667L6.38337 8ZM10.7834 8L7.73337 4.93333L8.66671 4L12.6667 8L8.66671 12L7.73337 11.0667L10.7834 8Z",fill:"#6C757D"}})])])]):t._e()])]):t._e()])]),e("AppealModal",{attrs:{appeal:this.modalProps},on:{clearProps:t.clearModalProps,showEditedAppeal:t.filterByEditedAppeal}})],1)},i=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"w-100 h-100 d-flex align-items-center justify-content-center"},[e("img",{attrs:{width:"192",height:"96",src:a(7049),alt:"Загрузка..."}})])}],l=(a(4114),a(1910)),r=function(){var t=this,e=t._self._c;return e("div",[e("div",{staticClass:"modal fade",attrs:{id:"appealModal",tabindex:"-1",role:"dialog","aria-labelledby":"auth-modalLabel"}},[e("div",{staticClass:"modal-dialog"},[e("div",{staticClass:"modal-content p-6"},[e("div",{staticClass:"modal-header my-2 p-0 d-flex justify-content-between"},[t.localAppeal.modalHeader.number&&t.localAppeal.modalHeader.date?e("div",[e("h3",[t._v("Заявка № "+t._s(t.localAppeal.modalHeader.number)+" (от "+t._s(t.localAppeal.modalHeader.date)+")")])]):e("b",[t._v("Создание заявки")]),t.localAppeal.modalHeader.status?e("b",[t._v("Статус: "+t._s(t.localAppeal.modalHeader.status))]):t._e(),t.localAppeal.modalHeader.number?t._e():e("b",[t._v("Новая")])]),e("div",{staticClass:"input-group-1 d-flex mb-6"},[e("div",{staticClass:"modal-inputs__item position-relative flex-grow-1 pb-2 me-3"},[e("div",{staticClass:"modal-inputs__item--message green-text-2 mb-2"},[t._v(" Дом ")]),e("div",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.localAppeal.full_address,expression:"localAppeal.full_address"}],attrs:{"data-info":"premise_id",type:"text",id:"premiseAddress",placeholder:t.localAppeal.full_address?"":"Не указано"},domProps:{value:t.localAppeal.full_address},on:{input:[function(e){e.target.composing||t.$set(t.localAppeal,"full_address",e.target.value)},function(e){return t.sendPremisesAutocompleteRequest(e.target.value)}]}})]),t.getPremisesAutocomplete.length?e("div",{staticClass:"choice position-absolute"},t._l(t.getPremisesAutocomplete,(function(a){return e("div",{key:a.id,staticClass:"choice-item p-2",on:{click:function(e){return t.applyAddressChoice(e.target,a.id)}}},[t._v(" "+t._s(a.full_address)+" ")])})),0):t._e()]),e("div",{staticClass:"modal-inputs__item position-relative flex-grow-1 pb-2 me-3"},[e("div",{staticClass:"modal-inputs__item--message green-text-2 mb-2"},[t._v(" Квартира ")]),e("div",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.localAppeal.apartment,expression:"localAppeal.apartment"}],attrs:{"data-info":"apartment",type:"text",id:"apartmentInput",placeholder:t.localAppeal.apartment?"":"Не указано"},domProps:{value:t.localAppeal.apartment},on:{input:[function(e){e.target.composing||t.$set(t.localAppeal,"apartment",e.target.value)},function(e){return t.sendApartmentAutocompleteRequest({apartment:e.target.value,premise:t.localAppeal.premise_id})}]}})]),t.getApartmentAutocomplete.length>0&&""!==t.formInputs?.apartmentInput?.value?e("div",{staticClass:"choice position-absolute"},t._l(t.getApartmentAutocomplete,(function(a){return e("div",{key:a.id,staticClass:"choice-item p-2",on:{click:function(e){return t.applyApartmentChoice(e.target,a.id)}}},[t._v(" "+t._s(a.number)+" ")])})),0):t._e()]),e("div",{staticClass:"modal-inputs__item flex-grow-1 pb-2"},[e("div",{staticClass:"modal-inputs__item--message green-text-2 mb-2"},[t._v(" Срок ")]),e("div",[e("input",{attrs:{"data-info":"due_date",type:"date",id:"due_date"},domProps:{value:t.myDate&&new Date(t.myDate.getTime()-60*t.myDate.getTimezoneOffset()*1e3).toISOString().split("T")[0]},on:{change:function(e){return t.onFormChange(e.target)},input:function(e){t.myDate=e.target.valueAsDate}}})])])]),e("div",{staticClass:"input-group-2 d-flex mb-6"},[e("div",{staticClass:"modal-inputs__item pb-2 me-3"},[e("div",{staticClass:"modal-inputs__item--message green-text-2 mb-2"},[t._v(" Фамилия ")]),e("div",[e("input",{attrs:{"data-info":"lastName",type:"text",placeholder:t.localAppeal.lastName??"Не указано"},domProps:{value:t.localAppeal.applicant.lastName},on:{input:function(e){return t.onFormChange(e.target)}}})])]),e("div",{staticClass:"modal-inputs__item pb-2 me-3"},[e("div",{staticClass:"modal-inputs__item--message green-text-2 mb-2"},[t._v(" Имя ")]),e("div",[e("input",{attrs:{"data-info":"firstName",type:"text",placeholder:t.localAppeal.firstName??"Не указано"},domProps:{value:t.localAppeal.applicant.firstName},on:{input:function(e){return t.onFormChange(e.target)}}})])]),e("div",{staticClass:"modal-inputs__item pb-2 me-3"},[e("div",{staticClass:"modal-inputs__item--message green-text-2 mb-2"},[t._v(" Отчество ")]),e("div",[e("input",{attrs:{"data-info":"patronymic",type:"text",placeholder:t.localAppeal.patronymic??"Не указано"},domProps:{value:t.localAppeal.applicant.patronymic},on:{input:function(e){return t.onFormChange(e.target)}}})])]),e("div",{staticClass:"modal-inputs__item pb-2"},[e("div",{staticClass:"modal-inputs__item--message green-text-2 mb-2"},[t._v(" Телефон ")]),e("div",[e("input",{directives:[{name:"model",rawName:"v-model",value:t.localAppeal.phone,expression:"localAppeal.phone"}],attrs:{"data-info":"phone",type:"number",placeholder:t.localAppeal.phone??"Не указано"},domProps:{value:t.localAppeal.phone},on:{change:function(e){return t.onFormChange(e.target)},input:function(e){e.target.composing||t.$set(t.localAppeal,"phone",e.target.value)}}})])])]),e("div",{staticClass:"modal-inputs__item pb-2 flex-grow-1"},[e("div",{staticClass:"modal-inputs__item--message green-text-2 mb-2"},[t._v(" Описание заявки ")]),e("textarea",{attrs:{"data-info":"description",placeholder:t.localAppeal.description??"Не указано"},domProps:{value:t.localAppeal.description},on:{input:function(e){return t.onFormChange(e.target)}}})]),e("button",{staticClass:"d-none",attrs:{id:"setDate"},on:{click:t.setDateFromAppeal}},[t._v("Set date")]),e("div",{staticClass:"d-flex ms-auto"},[e("button",{staticClass:"main-button mt-4 me-4",on:{click:function(e){return t.handleAppealChange(t.localAppeal)}}},[t._v("Сохранить")]),e("button",{staticClass:"main-button mt-4",on:{click:function(e){return t.closeModal()}}},[t._v("Закрыть")])]),t.modalLoading?e("div",{staticClass:"position-absolute loader border-radius-8 ease-animation"},[t.success?e("div",{staticClass:"border-radius-8 bg-white p-4 box-shadow"},[e("h4",{staticClass:"green-text-1"},[t._v("Успешно")])]):e("div",[e("img",{attrs:{width:"128",height:"64",src:a(7049),alt:"Загрузка"}})])]):t._e()])])])])},n=[],p=a(9930),o={name:"AppealModal",props:{appeal:null},computed:{...(0,l.L8)(["getPremisesAutocomplete","getApartmentAutocomplete"])},data(){return{appealModal:null,modalLoading:!1,success:!1,myDate:new Date("2000-01-01T00:01:01Z"),formInputs:{dueDateInput:null,addressInput:null,apartmentInput:null},localAppeal:{appeal_id:"",modalHeader:{number:"",date:""},applicant:{first_name:"",last_name:"",patronymic_name:"",username:""},phone:"",description:"",full_address:"",apartment:"",apartment_id:"",due_date:"",premise_id:""},setDateButton:""}},watch:{$props:{handler(){this.$props.appeal&&(this.$set(this.$data,"localAppeal",this.$props.appeal),this.setDateButton.click(),this.appealModal.show())},deep:!0}},methods:{...(0,l.i0)(["sendPremisesAutocompleteRequest","sendApartmentAutocompleteRequest","changeOrCreateAppeal"]),...(0,l.PY)(["setPremisesAutocomplete","setApartmentAutocomplete"]),onFormChange(t){"firstName"===t.dataset.info||"lastName"===t.dataset.info||"patronymic"===t.dataset.info?this.localAppeal.applicant[t.dataset.info]=t.value:this.localAppeal[t.dataset.info]=t.value},applyAddressChoice(t,e){this.formInputs.addressInput&&e&&(this.localAppeal.full_address=t.innerText,this.localAppeal.premise_id=e,this.setPremisesAutocomplete([]))},applyApartmentChoice(t,e){this.formInputs.apartmentInput&&e&&(this.localAppeal.apartment=t.innerText,this.localAppeal.apartment_id=e,this.setApartmentAutocomplete([]))},setDateFromAppeal(){this.localAppeal.due_date?this.myDate=new Date(this.localAppeal.due_date):(this.myDate=new Date(Date.now()),this.localAppeal.due_date=new Date(Date.now()).toISOString())},closeModal(){this.appealModal&&this.appealModal.hide()},handleAppealChange(t){this.modalLoading=!0,t.due_date&&(t.due_date=new Date(t.due_date).toISOString()),this.changeOrCreateAppeal(t).then((t=>{this.success=!0,setTimeout((()=>{this.closeModal(),this.success=!1,this.modalLoading=!1,this.$emit("showEditedAppeal",t)}),1e3)}))}},mounted(){this.formInputs.dueDateInput=this.$el.querySelector("#due_date"),this.formInputs.addressInput=this.$el.querySelector("#premiseAddress"),this.formInputs.apartmentInput=this.$el.querySelector("#apartmentInput"),this.setDateButton=this.$el.querySelector("#setDate"),this.appealModal=p.aF.getOrCreateInstance(document.querySelector("#appealModal"),{backdrop:!0,keyboard:!0}),this.myDate=new Date(this.myDate.setDate(this.myDate.getDate()+1)),this.$el.querySelector("#appealModal").addEventListener("hidden.bs.modal",(()=>{this.$emit("clearProps"),this.setPremisesAutocomplete([]),this.setApartmentAutocomplete([])}))}},c=o,d=a(1656),u=(0,d.A)(c,r,n,!1,null,"3b992e7d",null),h=u.exports,m={name:"RequestsList",components:{AppealModal:h},computed:{...(0,l.L8)(["getAppealsList","getAuthStatus","getPremisesData"])},data(){return{loading:!0,currentQuery:{page_size:"10",page:"1",premise_id:"",search:""},appealsData:{results:[]},paginationData:{page:"",page_next:"",page_previous:"",page_size:"",pages:""},premisesData:[],searchAppealInput:null,pageSizeSelect:null,premiseSelect:null,modalProps:null}},methods:{...(0,l.i0)(["sendAppealsRequest","sendPremisesRequest"]),...(0,l.PY)(["sortBy","pushNewToast"]),filterByEditedAppeal(t){t&&t.number&&(this.currentQuery.search=t.number,this.searchAppealInput.value=t.number),this.currentQuery.page=1,this.currentQuery.premise_id=""},searchAppealOnInput(){this.searchAppealInput&&setTimeout((()=>{this.currentQuery.search=this.searchAppealInput.value,this.currentQuery.page=1}),1e3)},searchAppealByClick(){this.searchAppealInput&&(this.currentQuery.search=this.searchAppealInput.value,this.currentQuery.page=1)},choosePremise(){if(this.premiseSelect){const t=this.premiseSelect.selectedIndex,e=this.premiseSelect[t].value;this.currentQuery.premise_id=e||"",this.currentQuery.page=1}},changePage(t){const e=t.target.dataset.action,a=Number(this.currentQuery.page);if(isNaN(Number(e)))switch(e){case"next":this.currentQuery.page=String(a+1);break;case"prev":a-1!==0&&(this.currentQuery.page=String(a-1));break;case"first":"1"!==this.paginationData.page&&(this.currentQuery.page="1");break;case"last":this.paginationData.page!==this.paginationData.pages&&(this.currentQuery.page=this.paginationData.pages);break}else this.paginationData.page!==Number(e)&&(this.currentQuery.page=e)},getMaxPages(){return this.paginationData.pages<5?this.paginationData.pages:5},getCurrentPage(t){return Number(this.paginationData.page)===this.getPagesArray()+t},getApplicant(t){let e={firstName:"",lastName:"",userName:"",patronymic:""};const a=t=>t&&t.startsWith("user_")?t.split("_")[1]:t;return t.created_by.first_name?e.firstName=a(t.created_by.first_name):e.firstName=null,t.created_by.last_name?e.lastName=a(t.created_by.last_name):e.lastName=null,t.created_by.patronymic?e.patronymic=a(t.created_by.patronymic):e.patronymic=null,t.created_by.username?e.userName=t.created_by.username:e.userName=null,e},getDate(t){if(t){const e=new Date(t),a=t=>1===String(t).length?"0"+t:t;return a(e.getDate())+"."+a(e.getMonth())+"."+e.getFullYear()+" "+a(e.getHours())+":"+a(e.getMinutes())}},changePageSize(){if(this.pageSizeSelect){const t=this.pageSizeSelect.selectedIndex,e=this.pageSizeSelect[t].value;e&&(this.currentQuery.page_size=e,this.currentQuery.page=1)}},updateTable(){this.loading=!0,this.sendAppealsRequest(this.currentQuery).then((()=>{Object.keys(this.getAppealsList).length&&(this.$set(this.appealsData,"results",this.getAppealsList?.results),this.$set(this.paginationData,"page",this.getAppealsList?.page),this.$set(this.paginationData,"page_next",this.getAppealsList?.page_next),this.$set(this.paginationData,"page_previous",this.getAppealsList?.page_previous),this.$set(this.paginationData,"page_size",this.getAppealsList?.page_size),this.$set(this.paginationData,"pages",this.getAppealsList?.pages),this.pageSizeSelect=this.$el.querySelector("select#pageSize"),this.$router.replace({query:this.currentQuery}).catch((()=>{})),setTimeout((()=>{this.loading=!1}),500))}))},getPagesArray(){const t=t=>{if(t>=5&&this.paginationData.pages>5){while(t%5!==0&&t<Number(this.paginationData.pages))t++;return t}return t},e=t(Number(this.paginationData.page));return e-5>0?e-5:0},showAppeal(t){let e;t&&(e=this.appealsData.results.find((e=>e.id===t))),this.prepareDataForModal(e)},prepareDataForModal(t){this.modalProps=t?.id?{appeal_id:t.id,modalHeader:{number:t?.number,date:this.getDate(t?.created_at).split(" ")[0],status:t.status.name},applicant:this.getApplicant(t),phone:t.applicant?.phone,description:t?.description,full_address:t.premise?.full_address,premise_id:t?.premise?.id,apartment:t.apartment?.number,due_date:t?.due_date,status:t.status}:{appeal_id:"",modalHeader:{number:"",date:""},applicant:{first_name:"",last_name:"",patronymic_name:"",username:""},phone:"",description:"",full_address:"",apartment:"",apartment_id:"",due_date:"",premise_id:"",status_id:1}},clearModalProps(){this.modalProps=null}},watch:{currentQuery:{handler:function(){this.updateTable()},deep:!0}},mounted(){this.getAuthStatus?(this.premiseSelect=this.$el.querySelector("select#premiseSelect"),this.searchAppealInput=this.$el.querySelector("#searchAppealInput"),this.sendPremisesRequest().then((()=>{this.$set(this.premisesData,"results",this.getPremisesData?.results)})),this.updateTable(),this.pushNewToast({type:"warning",header:"Работает простая сортировка по столбцам по возрастанию по клику",text:"Работает в пределах одной страницы. Чтобы было и на убывание требуется больше времени, опыт создания таких таблиц с сортировкой есть."})):this.$router.push({name:"Login"})}},g=m,_=(0,d.A)(g,s,i,!1,null,"20125b2b",null),v=_.exports}}]);
//# sourceMappingURL=649.14ccae45.js.map